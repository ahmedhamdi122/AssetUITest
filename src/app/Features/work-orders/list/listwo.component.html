<div class="col-12">
    <div class="row top-buffer">
        <div class="col-8">
            <h4 class="card-title"> {{'Asset.ListWorkOrders' | translate }} </h4>
        </div>
        <div class="col-2">
            <button type="button" class="btn excelIcon" (click)="exportExcel()"><i
                    class="fa-solid fa-file-excel fa-2xl"></i></button>
            <button type="button" class="btn pdfIcon" (click)="generatePDF()"><i
                    class="fa-solid fa-file-pdf fa-2xl"></i></button>

            <!-- <button type="button" class="btn wordIcon" (click)="generatePMPDF()" ><i
                class="fa-solid fa-file-word fa-2xl"></i></button> -->
        </div>
        <div class="col-2">

            <a data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="true"
                aria-controls="collapseExample" class="filterbutton">
                <i class="fa-solid fa-filter"></i> {{'Asset.Filter'|translate}}</a>
        </div>
    </div>
</div>



<div class="card-body">
    <div class="row top-buffer">
        <div class="col-10">
            <button mat-stroked-button [matBadge]="woStatusObj.countAll" (click)="getWOByStatusId(0,$event)">
                {{'Asset.All' | translate }}</button>
            <mat-action-list role="listitem" *ngFor="let sts of woStatusObj.listStatus">
                <button *ngIf="sts.id===1" mat-stroked-button [matBadge]="woStatusObj.countAssigned"
                    (click)="getWOByStatusId(sts.id,$event)" [ngStyle]="{'color': sts.color}">
                    <span><i [ngClass]="sts.icon"></i></span>
                    {{lang=="en"?sts.name:sts.nameAr}}
                </button>
                <button *ngIf="sts.id===2" mat-stroked-button [matBadge]="woStatusObj.countInProgress"
                    (click)="getWOByStatusId(sts.id,$event)" [ngStyle]="{'color': sts.color}">
                    <span><i [ngClass]="sts.icon"></i></span>
                    {{lang=="en"?sts.name:sts.nameAr}}
                </button>

                <button *ngIf="sts.id===6" mat-stroked-button [matBadge]="woStatusObj.countPending"
                    (click)="getWOByStatusId(sts.id,$event)" [ngStyle]="{'color': sts.color}">
                    <span><i [ngClass]="sts.icon"></i></span>
                    {{lang=="en"?sts.name:sts.nameAr}}
                </button>

                <button *ngIf="sts.id===7" mat-stroked-button [matBadge]="woStatusObj.countDone"
                    (click)="getWOByStatusId(sts.id,$event)" [ngStyle]="{'color': sts.color}">
                    <span><i [ngClass]="sts.icon"></i></span>
                    {{lang=="en"?sts.name:sts.nameAr}}
                </button>

                <button *ngIf="sts.id===8" mat-stroked-button [matBadge]="woStatusObj.countReview"
                    (click)="getWOByStatusId(sts.id,$event)" [ngStyle]="{'color': sts.color}">
                    <span><i [ngClass]="sts.icon"></i></span>
                    {{lang=="en"?sts.name:sts.nameAr}}
                </button>

                <button *ngIf="sts.id===9" mat-stroked-button [matBadge]="woStatusObj.countReAssigned"
                    (click)="getWOByStatusId(sts.id,$event)" [ngStyle]="{'color': sts.color}">
                    <span><i [ngClass]="sts.icon"></i></span>
                    {{lang=="en"?sts.name:sts.nameAr}}
                </button>

                <button *ngIf="sts.id===10" mat-stroked-button [matBadge]="woStatusObj.countTechApprove"
                    (click)="getWOByStatusId(sts.id)" [ngStyle]="{'color': sts.color}">
                    <span><i [ngClass]="sts.icon"></i></span>
                    {{lang=="en"?sts.name:sts.nameAr}}
                </button>

                <button *ngIf="sts.id===11" mat-stroked-button [matBadge]="woStatusObj.countUserApprove"
                    (click)="getWOByStatusId(sts.id)" [ngStyle]="{'color': sts.color}">
                    <span><i [ngClass]="sts.icon"></i></span>
                    {{lang=="en"?sts.name:sts.nameAr}}
                </button>

                <button *ngIf="sts.id===12" mat-stroked-button [matBadge]="woStatusObj.countClosed"
                    (click)="getWOByStatusId(sts.id)" [ngStyle]="{'color': sts.color}">
                    <span><i [ngClass]="sts.icon"></i></span>
                    {{lang=="en"?sts.name:sts.nameAr}}
                </button>
            </mat-action-list>
        </div>

    </div>
    <div class="col-12  top-buffer">
        <div id="collapseExample" class="collapse row card-filter">
            <form (ngSubmit)="onSearch()" #searchForm="ngForm">
                <div class="row top-buffer">
                    <div class="col-2">
                        <label for="governorate" [translate]="'Asset.Governorates'">Governorate</label>
                        <select class="form-control" id="governorate" name="governorate" #governorate="ngModel"
                            [value]="0" [(ngModel)]="sortFilterObjects.searchObj.governorateId" [disabled]="isGov"
                            (change)="getCitiesByGovId(sortFilterObjects.searchObj.governorateId)">
                            <option value="0"> </option>
                            <option *ngFor="let gov of lstGovernorates" [value]="gov.id">
                                {{ lang == "en" ? gov.name : gov.nameAr }}
                            </option>
                        </select>
                    </div>
                    <div class="col-2">
                        <label for="cityId" [translate]="'Asset.Cities'">City</label>
                        <select class="form-control" id="city" name="city" #cityId="ngModel"
                            [(ngModel)]="sortFilterObjects.searchObj.cityId" [value]="0" [disabled]="isCity">
                            <option value="0"> </option>
                            <option *ngFor="let city of lstCities" [value]="city.id">
                                {{ lang == "en" ? city.name : city.nameAr }}
                            </option>
                        </select>
                    </div>
                    <div class="col-2">
                        <label for="organization" [translate]="'Asset.Organizations'">Organization</label>
                        <select class="form-control" id="organization" name="organization"
                            [(ngModel)]="sortFilterObjects.searchObj.organizationId" (change)="getSubOrgByOrgId($event)"
                            [value]="0" [disabled]="isOrg">
                            <option value="0"></option>
                            <option *ngFor="let org of lstOrganizations" [value]="org.id">
                                {{ lang == "en" ? org.name : org.nameAr }}
                            </option>
                        </select>
                    </div>
                    <div class="col-2">
                        <label for="organization" [translate]="'Asset.SubOrganizations'">Sub
                            Organization</label>
                        <select class="form-control" id="suborganization" name="suborganization" [value]="0"
                            [disabled]="isSubOrg" (change)="getHospitalsBySubOrgId()"
                            [(ngModel)]="sortFilterObjects.searchObj.subOrganizationId" #suborganization="ngModel">
                            <option value="0"></option>
                            <option *ngFor="let suborg of lstSubOrganizations" [value]="suborg.id">
                                {{ lang == "en" ? suborg.name : suborg.nameAr }}
                            </option>
                        </select>
                    </div>


                    <div class="col-2">
                        <label for="hospitalId" [translate]="'Asset.Hospitals'">Hospitals</label>
                        <select class="form-control" id="hospitalId" [disabled]="isHospital" name="hospitalId"
                            [(ngModel)]="sortFilterObjects.searchObj.hospitalId" [value]="0"
                            (change)="getAssetsByHospitalId($event)">
                            <option value="0"></option>
                            <option *ngFor="let host of lstHospitals" [value]="host.id">
                                {{ lang == "en" ? host.name : host.nameAr }}
                            </option>
                        </select>
                    </div>
                    <div class="col-2">
                        <label for="assetName" [translate]="'Asset.Name'"></label><br />
                        <p-autoComplete [suggestions]="lstMasterAssets" type="search" name="masterAssetId"
                            id="masterAssetId" (completeMethod)="onMasterSelectionChanged($event)"
                            (onSelect)="getMasterObject($event)" field="name" [dropdown]="false">
                            <ng-template let-masterAssetObj pTemplate="item">
                                {{lang ==="en" ? masterAssetObj.name:masterAssetObj.nameAr}} -
                                {{lang ==="en" ? masterAssetObj.brandName:masterAssetObj.brandNameAr}}
                                - {{masterAssetObj.model}}
                            </ng-template>
                            <ng-template let-masterAssetObj pTemplate="selectedItem">
                                {{lang=="en" ?masterAssetObj.name:masterAssetObj.nameAr}} -
                                {{lang ==="en" ? masterAssetObj.brandName:masterAssetObj.brandNameAr}}
                                - {{masterAssetObj.model}}
                            </ng-template>
                        </p-autoComplete>
                    </div>
                    <div class="col-2">
                        <label for="barcode" [translate]="'Asset.Barcode'"></label>
                        <p-autoComplete [(ngModel)]="assetBarCodeObj" [ngModelOptions]="{standalone: true}"
                            [suggestions]="lstassetDetailBarcodes" name="barcode" id="barcode" autoWidth="true"
                            (completeMethod)="onSelectionChanged($event)" (onSelect)="getBarCode($event)" field="name"
                            [dropdown]="false" showClear="true">
                            <ng-template let-assetBarCodeObj pTemplate="item">
                                {{assetBarCodeObj.barCode}}
                            </ng-template>
                            <ng-template let-assetBarCodeObj pTemplate="selectedItem">
                                {{assetBarCodeObj.barCode}}
                            </ng-template>
                        </p-autoComplete>
                    </div>

                    <div class="col-2">
                        <label for="serial" [translate]="'Asset.Serial'">{{'Asset.Serial'| translate}}</label>
                        <p-autoComplete type="search" [(ngModel)]="assetSerailNumberObj"
                            [ngModelOptions]="{standalone: true}" [suggestions]="lstAssetSerailNumberObj" name="serial"
                            id="serial" autoWidth="true" (completeMethod)="onSerialNumberSelectionChanged($event)"
                            (onSelect)="getSerialNumber($event)" field="name" [dropdown]="false">
                            <ng-template let-assetSerailNumberObj pTemplate="item">
                                {{assetSerailNumberObj.serialNumber}}
                            </ng-template>
                            <ng-template let-assetSerailNumberObj pTemplate="selectedItem">
                                {{assetSerailNumberObj.serialNumber}}
                            </ng-template>
                        </p-autoComplete>
                    </div>
                    <div class="col-2">
                        <label for="model" [translate]="'Asset.Model'"></label>
                        <input type="text" class="form-control" [(ngModel)]="sortFilterObjects.searchObj.modelNumber"
                            [ngModelOptions]="{standalone: true}" />
                    </div>
                    <div class="col-2">
                        <label for="departmentId" [translate]="'Asset.Departments'">Departments</label>
                        <select class="form-control" id="departmentId" name="departmentId"
                            [(ngModel)]="sortFilterObjects.searchObj.departmentId" [value]="0">
                            <option value="0">
                            <option *ngFor="let depart of lstDepartments" [value]="depart.id">
                                {{ lang == "en" ? depart.name : depart.nameAr }}
                            </option>
                        </select>
                    </div>
                    <div class="col-2">
                        <label for="wonumber" [translate]="'Asset.WONumber'"> {{'Asset.WONumber' | translate
                            }}</label>
                        <input type="text" class="form-control" [(ngModel)]="sortFilterObjects.searchObj.woNumber"
                            [ngModelOptions]="{standalone: true}" />
                    </div>
                    <!-- <div class="col-2">
                            <label for="statusId" [translate]="'Asset.Status'"></label>
                            <select class="form-control" id="statusId" [ngModelOptions]="{standalone: true}"
                                name="statusId" [(ngModel)]="sortFilterObjects.searchObj.statusId" [value]="0">
                                <option value="0"></option>
                                <option *ngFor="let sts of lstStatuses" [value]="sts.id">
                                    {{ lang == "en" ? sts.name : sts.nameAr }}
                                </option>
                            </select>
                        </div> -->

                    <div class="col-2">
                        <label for="subject"> {{'Asset.Subject' | translate
                            }}</label>
                        <input type="text" class="form-control" [(ngModel)]="sortFilterObjects.searchObj.subject"
                            [ngModelOptions]="{standalone: true}" />
                    </div>
                    <div class="col-2">
                        <label for="subject"> {{'Asset.SRSubject' | translate
                            }}</label>
                        <input type="text" class="form-control" [(ngModel)]="sortFilterObjects.searchObj.requestSubject"
                            [ngModelOptions]="{standalone: true}" />
                    </div>
                    <div class="col-2">
                        <label for="start"> {{'Asset.StartDate' | translate }}</label>
                        <input type="date" class="form-control" [(ngModel)]="sortFilterObjects.searchObj.start"
                            [ngModelOptions]="{standalone: true}" />
                    </div>
                    <div class="col-2">
                        <label for="code" [translate]="'Asset.EndDate'"> {{'Asset.EndDate' | translate
                            }}</label>
                        <input type="date" class="form-control" [(ngModel)]="sortFilterObjects.searchObj.end"
                            [ngModelOptions]="{standalone: true}" />
                    </div>
                    <div class="col-4"></div>
                    <div class="col-1"> <button class="btn searchIcon" value="save" type="submit">
                            <i class="fa-solid fa-magnifying-glass fa-2xl"></i>
                        </button></div>
                    <div class="col-1"> <button class="btn reset" value="Reset" type="button" (click)="reset()">
                            <i class="fa-solid fa-circle-xmark  fa-2xl"></i>
                        </button></div>
                </div>


            </form>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <p-table #wotable [value]="lstWorkOrders"
                styleClass="p-datatable-sm p-datatable-striped p-datatable-gridlines" responsiveLayout="scroll"
                [paginator]="true" [lazy]="true" [rows]="10" [totalRecords]="count" pageLinks="10"
                (onLazyLoad)="clicktbl($event)" [loading]="loading" [columns]="selectedColumns" [rowHover]="true">
                <ng-template pTemplate="caption">
                    <p-multiSelect [options]="cols" name="ddlCols" [(ngModel)]="selectedColumns" optionLabel="header"
                        selectedItemsLabel="{0} {{columnsSelected}}" [style]="{minWidth: '200px'}"
                        [placeholder]="'Asset.ChooseColumns' |translate">
                    </p-multiSelect>
                </ng-template>
                <ng-template pTemplate="header" let-cols>
                    <tr>
                        <th style="text-align: inherit;display: none;"></th>
                        <th style="text-align: inherit;"></th>
                        <th style="text-align: inherit;" [sortable]="true" *ngFor="let col of cols">
                            {{col.header}}
                            <p-sortIcon id="{{col.header | translate}}" (click)="sort($event)"
                                *ngIf="col.field !== 'elapsedTime'">
                            </p-sortIcon>
                        </th>
                        <th> {{'Asset.Actions' | translate }}</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-item let-columns="columns">
                    <tr>
                        <!-- <td style="text-align: inherit;display: none;">
                            <ngx-barcode [bc-value]="item.workOrderNumber" id="barcode_{{item.id}}"
                                [bc-display-value]="true" width="30" height="10" [bc-element-type]="elementType">
                            </ngx-barcode>
                        </td> -->
                        <td style="text-align: inherit;">
                            <mat-checkbox id="ckbx{{item.id}}" name="ckbx{{item.id}}"
                                (change)="checkedWO($event, item.id)" [value]="item.id">
                            </mat-checkbox>
                        </td>
                        <ng-container *ngFor=" let col of columns">
                            <td style="text-align: inherit;"
                                *ngIf="col.field =='assetName' || col.field =='assetNameAr'">
                                <span style="text-decoration-line: underline;" (click)="viewDetail(item.id)">
                                    {{lang=="en" ? item.assetName:item.assetNameAr}}
                                </span>
                            </td>
                            <td style="text-align: inherit;"
                                *ngIf="col.field !='assetName' && col.field !='assetNameAr' &&col.field !='creationDate' && col.field !== 'statusName' && col.field !== 'statusNameAr' && col.field !='requestSubject'  && col.field !== 'closedDate'">
                                {{item[col.field]}}
                            </td>
                            <td style="text-align: inherit;" *ngIf="col.field=='creationDate'">
                                {{item.creationDate | date:'dd-MM-yyyy HH:mm'}}
                            </td>
                            <td style="text-align: inherit;" *ngIf="col.field=='closedDate'">
                                {{item.closedDate | date:'dd-MM-yyyy HH:mm'}}
                            </td>
                            <td style="text-align: inherit;" *ngIf="col.field =='statusNameAr'">
                                <span [ngStyle]="{'color':item.statusColor}">
                                    <span><i [ngClass]="item.statusIcon"></i></span>
                                    {{lang=="en" ? item.statusName:item.statusNameAr}}
                                </span>
                            </td>
                            <td style="text-align: inherit;" *ngIf="col.field =='statusName'">
                                <span [ngStyle]="{'color':item.statusColor}">
                                    <span><i [ngClass]="item.statusIcon"></i></span>
                                    {{lang=="en" ? item.statusName:item.statusNameAr}}
                                </span>
                            </td>
                            <td style="text-align: inherit;" *ngIf="col.field =='requestSubject'"
                                (click)="gotoViewRequest(item.requestId)">
                                {{item.requestSubject}}</td>
                        </ng-container>
                        <td style="text-align: inherit;">
                            <span pTooltip="{{'Asset.View' | translate}}" tooltipPosition="top"
                                (click)="viewWorkOrder(item.id)">
                                <i class="fa-solid fa-eye" style="color: #61bb20; cursor: pointer;margin: 0px 5px;"></i>
                            </span>
                            <span *ngIf="item.workOrderStatusId < 2">
                                <span pTooltip="{{'Asset.Start' | translate}}" tooltipPosition="top"
                                    *ngIf="isEngManager && ((item.workOrderStatusId < 7) || (item.workOrderStatusId == 9))"
                                    (click)="startWO(item.id)">
                                    <i class="fa-solid fa-battery-half"
                                        style="color: #F58840; cursor: pointer;margin: 0px 5px;"></i>
                                </span>
                            </span>
                            <span *ngIf="item.workOrderStatusId >= 2">
                                <span pTooltip="{{'Asset.Note' | translate}}" tooltipPosition="top"
                                    (click)="woSparePart(item.id)"
                                    *ngIf="isEngManager && ((item.workOrderStatusId < 7) || (item.workOrderStatusId == 9))">
                                    <i class=" fa fa-sticky-note" style="color: #89272a;margin: 0px 5px;"></i>
                                </span>
                                <span pTooltip="{{'Asset.Done' | translate}}" tooltipPosition="top"
                                    *ngIf="isEngManager && ((item.workOrderStatusId < 7) || (item.workOrderStatusId == 9))"
                                    (click)="woDone(item.id)">
                                    <i class="fa-solid fa-clipboard-check" style="color: #bb9b4c;margin: 0px 5px;"></i>
                                </span>
                            </span>
                            <span pTooltip="{{'Asset.Reviewed' | translate}}" tooltipPosition="top"
                                *ngIf="isEngManager && item.workOrderStatusId == 11">
                                <i class="fa-solid fa-check-double" style="color: #0d4f28;margin: 0px 5px;"></i>
                            </span>
                            <span pTooltip="{{'Asset.Print'| translate}}" tooltipPosition="top"
                                (click)="GetWOById(item.id)" *ngIf="isEngManager">
                                <i class="fa-solid fa-print"
                                    style="color: #052e55;margin: 0px 5px;cursor: pointer;"></i>
                            </span>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</div>


<p-dialog appendTo="body" modal="true" [(visible)]="display" [style]="{ width: '350px' }">
    <ng-template pTemplate="header">
        <h6 style="color: #04527e; font-weight: bold; font-size: 16pt">
            {{ "Asset.Save" | translate }}
        </h6>
    </ng-template>
    <span style="color: green; font-weight: bold; font-size: 12pt; text-align: center">
        {{ "Asset.SavedSuccess" | translate }}</span>
</p-dialog>

<p-dialog appendTo="body" modal="true" [(visible)]="errorDisplay" [style]="{ width: '350px' }">
    <p-header style="color: rgb(181, 4, 4)">
        {{ "Asset.Error" | translate }}
    </p-header>
    <span style="color: rgb(181, 4, 4); font-weight: bold">
        {{ errorMessage }}</span>
</p-dialog>


<p-dialog appendTo="body" modal="true" [(visible)]="startDisplay" [style]="{ width: '350px' }">
    <p-header style="color: #9f4408">
        {{ "Asset.Save" | translate }}
    </p-header>
    <span style="color: #9f4408; font-weight: bold">
        {{ startMessage }}</span>
</p-dialog>

<p-dialog appendTo="body" modal="true" [(visible)]="displayWOObj" [style]="{ width: '900px' }" [closable]="false">
    <button (click)="print()">{{'Asset.Print' | translate}}</button>
    <button (click)="closePrint()" class="btn btn-outline-primary  btn-sm" id="non-printable"
        style="margin: 0px 10px; margin-top: 0px;">{{'Asset.Close' | translate}}</button>
    <div id="printable">
        <div class="row top-buffer"></div>
        <div class="row top-buffer" style="direction: rtl;">
            <div class="col-6"
                style="text-align: right;font-weight: bold;font-size: 20pt;font-family:Arial;color: black;">قطاع
                مشروعات الصحة</div>
            <div class="col-6" style="text-align: left;color: black;">Report No. 1</div>
        </div>
        <div class="row top-buffer"></div>
        <div class="row top-buffer"></div>
        <div class="row top-buffer" style="text-align:center">
            <div class="col-12" style="font-weight: bold;font-size:20px;color: black;font-family:Arial">Job Sheet /
                تقرير عمل </div>
        </div>
        <div class="row top-buffer"></div>
        <div class="row top-buffer"></div>
        <table style="direction: rtl;border: 1px solid black;width: 100%;">
            <tr>
                <td>
                    <table style="width:100%;">
                        <tr>
                            <td style="width: 120px;font-family: Arial;font-size:18px;">العميل</td>
                            <td style="font-family: Arial;font-size:18px;">
                                {{lang=="en"?currentUser.strInsitute:currentUser.strInsituteAr}} -
                                {{lang=="en"?printWorkOrderObj.hospitalName:printWorkOrderObj.hospitalNameAr}}
                            </td>
                            <td></td>
                            <td></td>
                            <td style="direction: ltr;width: 150px;text-align: left;font-size: 18px;">Customer</td>
                        </tr>
                        <tr>
                            <td style="width: 120px;font-family: Arial;font-size: 18px;">العنوان</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td style="direction: ltr;width: 150px;text-align: left;font-size: 18px;">Address</td>
                        </tr>
                        <tr>
                            <td style="width: 120px;font-family: Arial;font-size: 18px;">التاريخ</td>
                            <td style="font-family:Arial;font-size: 20px;">
                                {{printWorkOrderObj.closedDate}}
                            </td>
                            <td></td>
                            <td></td>
                            <td style="direction: ltr;width: 150px;text-align: left;font-size: 18px;">Date</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        <div class="row top-buffer"></div>
        <table style="direction: rtl;border: 1px solid black;width: 100%;">
            <tr>
                <td>
                    <table style="width:100%;">
                        <tr>
                            <td style="font-family: Arial;font-size: 18px;">القسم</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td style="direction: ltr;width: 150px;text-align: left;font-size: 18px;">Department</td>
                        </tr>
                        <tr>
                            <td style="font-family: Arial;font-size: 20px;">غرفة رقم</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td style="direction: ltr;width: 150px;text-align: left;font-size:18px;">Room No.</td>
                        </tr>
                        <tr>
                            <td style="font-family: Arial;font-size: 18px;">اسم المستخدم</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td style="direction: ltr;width: 150px;text-align: left;font-size: 18px;">User name</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        <div class="row top-buffer"></div>
        <table style="direction: rtl;border: 1px solid black;width: 100%;">
            <tr>
                <td>
                    <table style="width:100%;">
                        <tr>
                            <td style="width: 120px;font-family: Arial;font-size: 18px;">المصنع / المنتج</td>
                            <td style="font-size: 20px;">
                                {{lang=="en"?printWorkOrderObj.brandName:printWorkOrderObj.brandNameAr}}</td>
                            <td></td>
                            <td></td>
                            <td style="direction: ltr;width: 150px;text-align: left;font-size: 18px;">Manufacture</td>
                        </tr>
                        <tr>
                            <td style="width: 120px;font-family: Arial;font-size: 18px;">الجهاز</td>
                            <td style="font-size: 20px;">
                                {{lang=="en"?printWorkOrderObj.assetName:printWorkOrderObj.assetNameAr}}</td>
                            <td></td>
                            <td></td>
                            <td style="direction: ltr;width: 150px;text-align: left;font-size: 18px;">Equipment</td>
                        </tr>
                        <tr>
                            <td style="width: 120px;font-family: Arial;font-size: 18px;">رقم مسلسل</td>
                            <td [ngStyle]="{'direction': lang === 'en' ? 'ltr': 'ltr'}" style="font-size: 18px;">
                                {{printWorkOrderObj.serialNumber}}</td>
                            <td></td>
                            <td></td>
                            <td style="direction: ltr;width: 150px;text-align: left;font-size: 18px;">S.N.</td>
                        </tr>
                        <tr>
                            <td style="width: 120px;font-family: Arial;font-size: 18px;">الموديل</td>
                            <td style="font-size: 18px;">{{printWorkOrderObj.modelNumber}}</td>
                            <td></td>
                            <td></td>
                            <td style="direction: ltr;width: 150px;text-align: left;font-size: 18px;">Model</td>
                        </tr>
                        <tr>
                            <td style="width: 120px;font-family: Arial;font-size: 18px;">الرقم الكودي</td>
                            <td style="font-size: 18px;">{{printWorkOrderObj.barCode}}</td>
                            <td></td>
                            <td></td>
                            <td style="direction: ltr;width: 150px;text-align: left;font-size: 18px;">Barcode</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        <div class="row top-buffer"></div>
        <div class="row top-buffer" style="text-align:center">
            <div class="col-12" style="font-weight: bold;font-size:20px;font-family: Arial; color: black;">Complain /
                نوع العطل</div>
        </div>
        <table style="direction: rtl;border: 1px solid grey;width: 100%;font-family: Arial">
            <tr>
                <td style="height: 90px;vertical-align: top;font-family: Arial;font-size: 18px;">
                    {{printWorkOrderObj.firstRequest}}
                </td>
            </tr>
        </table>
        <div class="row top-buffer"></div>
        <div class="row top-buffer" style="text-align:center">
            <div class="col-12" style="font-weight: bold;font-size:20px;font-family: Arial;color: black;">Work Done / ما
                تم إنجازه
            </div>
        </div>
        <table style="direction: rtl;border: 1px solid grey;width: 100%;font-family: Arial">
            <tr>
                <td style="height: 90px;vertical-align: top;font-family: Arial;font-size: 18px;">
                    {{printWorkOrderObj.lastWorkOrder}}
                </td>
            </tr>
        </table>
        <div class="row top-buffer"></div>

        <div class="row top-buffer"></div>
        <div class="row top-buffer" style="text-align:center" *ngIf="printWorkOrderObj.lstWorkOrderTracking.length >0">
            <div class="col-12" style="font-weight: bold;font-size:20px;font-family: Arial;color: black;">All WorkOrders
                كل أوامر الشغل
            </div>
        </div>
        <table style="direction: rtl;border: 1px solid grey;width: 100%;font-family: Arial">
            <tr *ngFor="let track of printWorkOrderObj.lstWorkOrderTracking">
                <td style="font-family: Arial;font-size: 18px;color: black;">
                    - {{track.notes}}
                </td>
            </tr>
        </table>
        <div class="row top-buffer"></div>

        <table style="direction: rtl;border: 1px solid black;width: 100%;">
            <tr>
                <td>

                    <table style="width:100%;direction: rtl; border-collapse: separate; border-spacing: 3px;">

                        <tr>
                            <td style="border: 1px solid black;padding:10px;text-align: center;font-family: Arial;color: black;font-size: 16px;"
                                rowspan="2">
                                الكمية / Qty </td>
                            <td style="border: 1px solid black;padding:10px;text-align: center;font-family: Arial;color: black;font-size: 16px;"
                                rowspan="2">
                                الوصف / Description
                            </td>
                            <td style="border: 1px solid black;padding:10px;text-align: center;font-family: Arial;color: black;font-size: 16px;"
                                rowspan="2">
                                الكود / Code </td>
                            <td
                                style="border: 1px solid black;text-align: center;width:250px;font-family: Arial;color: black;font-size: 16px;">
                                قطع
                                الغيار / Spare
                                Parts </td>
                        </tr>
                        <tr>

                            <td style="text-align: right;direction: rtl; width: 100px;">
                                <table style="border-collapse: separate; border-spacing: 1px;">
                                    <tr>
                                        <td
                                            style="border: 1px solid black;text-align: center;width: 150px;height: 30px;color: black;font-family:Arial;font-size: 16px;">
                                            مطلوبة / Ordered </td>
                                        <td
                                            style="border: 1px solid black;text-align: center;width: 100px;height: 30px;color: black;font-family:Arial;font-size: 16px;">
                                            متوفر / Used </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>

                        <tr>
                            <td style="border: 1px dashed black;height: 25px; border-spacing:10px"></td>
                            <td style="border: 1px dashed black;height: 25px; border-spacing:10px"></td>
                            <td style="border: 1px dashed black;height: 25px; border-spacing:10px"></td>
                            <td>
                                <table style="border-collapse: separate; border-spacing: 1px;">
                                    <tr>
                                        <td
                                            style="border: 1px dashed black;text-align: center;width: 150px;height: 30px;">
                                        </td>
                                        <td
                                            style="border: 1px dashed black;text-align: center;width: 100px;height: 30px;">
                                        </td>
                                    </tr>
                                </table>

                            </td>
                        </tr>
                        <tr>
                            <td style="border: 1px dashed black;height: 25px; border-spacing:10px"></td>
                            <td style="border: 1px dashed black;height: 25px; border-spacing:10px"></td>
                            <td style="border: 1px dashed black;height: 25px; border-spacing:10px"></td>
                            <td>
                                <table style="border-collapse: separate; border-spacing: 1px;">
                                    <tr>
                                        <td
                                            style="border: 1px dashed black;text-align: center;width: 150px;height: 30px;">
                                        </td>
                                        <td
                                            style="border: 1px dashed black;text-align: center;width: 100px;height: 30px;">
                                        </td>
                                    </tr>
                                </table>

                            </td>
                        </tr>
                        <tr>
                            <td style="border: 1px dashed black;height: 25px; border-spacing:10px"></td>
                            <td style="border: 1px dashed black;height: 25px; border-spacing:10px"></td>
                            <td style="border: 1px dashed black;height: 25px; border-spacing:10px"></td>
                            <td>
                                <table style="border-collapse: separate; border-spacing: 1px;">
                                    <tr>
                                        <td
                                            style="border: 1px dashed black;text-align: center;width: 150px;height: 30px;">
                                        </td>
                                        <td
                                            style="border: 1px dashed black;text-align: center;width: 100px;height: 30px;">
                                        </td>
                                    </tr>
                                </table>

                            </td>
                        </tr>

                    </table>
                </td>
            </tr>
        </table>
        <div class="row top-buffer"></div>

        <table style="direction: rtl;border: 1px solid black;width: 100%;">
            <tr>
                <td>

                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th></th>
                                <th style="color: black;font-family:Arial;font-size: 18px;">
                                    عن المستشفى
                                </th>
                                <th></th>
                                <th style="color: black;font-family:Arial;font-size: 18px;">مهندس الصيانة</th>

                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <!-- - {{lastYear}} {{nextYear}} - {{thisYear}}-->
                                <td style="font-weight: bold;color: black;font-size: 18px;">2022 - 2023<br />
                                    <span style="font-weight: normal;color: black;font-size: 18px;">
                                        MOH
                                    </span>
                                </td>
                                <td style="color: black;font-family:Arial;font-size:18px;">{{'Asset.Name'|translate }}
                                    <br />
                                    {{'Asset.Sign'|translate }}
                                    <br />
                                    {{'Asset.Date'|translate }}
                                </td>
                                <td></td>
                                <td style="color: black;font-family:Arial;font-size: 18px;">
                                    {{'Asset.Name'|translate }}
                                    <br />
                                    {{'Asset.Sign'|translate }}
                                    <br />
                                    {{'Asset.Date'|translate}}
                                    <div style="text-align:left ;font-size: 15px;">
                                        (HSF04-01)
                                    </div>
                                </td>

                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
        </table>
    </div>

</p-dialog>